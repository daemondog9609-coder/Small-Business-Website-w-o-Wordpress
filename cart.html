<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Your Cart</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="shop.css" />
    <style>
      .cart-summary{ max-width:900px; margin:28px auto; padding:18px; background:#fff; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,0.06); }
      .cart-list{ width:100%; border-collapse:collapse; }
      .cart-list th,.cart-list td{ padding:10px 8px; text-align:left; border-bottom:1px solid #eee; }
      .cart-list img{ width:72px; height:60px; object-fit:cover; border-radius:8px; }
      .cart-actions-row{ display:flex; gap:12px; justify-content:flex-end; margin-top:14px; }
      .muted{ color:#666; }
      .empty-state{ padding:36px; text-align:center; color:#666; }
    </style>
  </head>
  <body>
    <header>
      <a href="index.html"><img src="/Images/Fera_symbol.jpg" alt="Logo" style="margin-left: 10px; width: 149px; height: auto;"></a>
    </header>

    <main class="content">
      <div class="cart-summary">
        <h1>Your Cart</h1>
        <div id="cart-root">
          <div class="empty-state">Loading...</div>
        </div>
      </div>
    </main>

    <footer class="site-footer">
      <div class="footer-inner">
        <div class="footer-left">
          <p>© 2025 FERA — Nature's Design</p>
        </div>
        <div class="footer-right">
          <span class="follow">Follow us</span>
          <a class="social" href="https://www.instagram.com/feraforged/" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M7 2h10a5 5 0 015 5v10a5 5 0 01-5 5H7a5 5 0 01-5-5V7a5 5 0 015-5z" stroke="#2b2b2b" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 8.5a3.5 3.5 0 100 7 3.5 3.5 0 000-7z" stroke="#2b2b2b" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/><path d="M17.5 6.5h.01" stroke="#2b2b2b" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </a>
          <a class="social" href="#" aria-label="Facebook">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M18 2h-3a4 4 0 00-4 4v3H8v4h3v8h4v-8h3l1-4h-4V6a1 1 0 011-1h3V2z" stroke="#2b2b2b" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </a>
          <a class="social" href="#" aria-label="Twitter">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M23 3a10.9 10.9 0 01-3.14 1.53A4.48 4.48 0 0016.5 3c-2.5 0-4.5 2.28-3.97 4.73A12.94 12.94 0 013 4s-4 9 5 13a13 13 0 01-8 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z" stroke="#2b2b2b" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </a>
        </div>
      </div>
    </footer>

    <script>
      (function(){
        function readCart(){ try{ return JSON.parse(localStorage.getItem('cart')||'[]'); }catch(e){ return []; } }
        function writeCart(cart){ localStorage.setItem('cart', JSON.stringify(cart)); updateCounts(); }
        function format(n){ return '$' + Number(n).toFixed(2); }

        function updateCounts(){
          const cart = readCart();
          const totalItems = cart.reduce((s,it)=> s + (Number(it.qty)||0), 0);
          const countEl = document.getElementById('cart-count'); if(countEl) countEl.textContent = String(totalItems);
          const gCount = document.getElementById('global-cart-count'); if(gCount) gCount.textContent = String(totalItems);
        }

        function render(){
          const root = document.getElementById('cart-root');
          const items = readCart();
          if(!root) return;
          if(!items || items.length === 0){
            root.innerHTML = '<div class="empty-state">Your cart is empty.<br><a href="Shop.html" class="btn">Continue shopping</a></div>';
            updateCounts();
            return;
          }

          let html = '';
          html += '<table class="cart-list">';
          html += '<thead><tr><th>Product</th><th>Unit</th><th>Qty</th><th>Subtotal</th><th></th></tr></thead>';
          html += '<tbody>';
          let total = 0;
          items.forEach(item=>{
            const qty = Number(item.qty)||0;
            const subtotal = (Number(item.price)||0) * qty; total += subtotal;
            html += '<tr data-id="'+(item.id||'')+'">';
            html += '<td>' + (item.name||'Product') + '</td>';
            html += '<td>' + format(item.price) + '</td>';
            html += '<td>' +
                    '<button class="dec-line" data-id="'+(item.id||'')+'">−</button>' +
                    ' <span class="line-qty">'+qty+'</span> ' +
                    '<button class="inc-line" data-id="'+(item.id||'')+'">+</button>' +
                    '</td>';
            html += '<td>' + format(subtotal) + '</td>';
            html += '<td><button class="btn remove-item" data-id="'+(item.id||'')+'">Remove</button></td>';
            html += '</tr>';
          });
          html += '</tbody>';
          html += '</table>';
          html += '<div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">';
          html += '<div class="muted">Items: ' + items.reduce((s,it)=> s + (Number(it.qty)||0),0) + '</div>';
          html += '<div style="font-weight:800;font-size:1.15rem">Total: ' + format(total) + '</div>';
          html += '</div>';
          html += '<div class="cart-actions-row">';
          html += '<button id="clear-cart" class="btn">Clear cart</button>';
          html += '<a href="checkout.html" class="btn">Checkout</a>';
          html += '</div>';

          root.innerHTML = html;

          // bind remove buttons
          root.querySelectorAll('.remove-item').forEach(b=>{
            b.addEventListener('click', function(){
              const id = this.dataset.id;
              const current = readCart();
              const filtered = current.filter(it=> it.id !== id);
              writeCart(filtered);
              render();
            });
          });

          // bind inc/dec per line
          root.querySelectorAll('.inc-line').forEach(b=> b.addEventListener('click', function(){
            const id = this.dataset.id; const cart = readCart(); const idx = cart.findIndex(it=> it.id === id); if(idx>=0){ cart[idx].qty = (Number(cart[idx].qty)||0)+1; writeCart(cart); render(); }
          }));
          root.querySelectorAll('.dec-line').forEach(b=> b.addEventListener('click', function(){
            const id = this.dataset.id; const cart = readCart(); const idx = cart.findIndex(it=> it.id === id); if(idx>=0){ cart[idx].qty = Math.max(0,(Number(cart[idx].qty)||0)-1); if(cart[idx].qty<=0) cart.splice(idx,1); writeCart(cart); render(); }
          }));

          const clearBtn = document.getElementById('clear-cart');
          if(clearBtn){
            clearBtn.addEventListener('click', function(){ if(confirm('Clear cart?')){ writeCart([]); render(); } });
          }

          updateCounts();
        }

        document.addEventListener('DOMContentLoaded', function(){ render(); });
      })();
    </script>
  </body>
</html>

